---
title: Introduction to Mixed-Effects Modeling for Linguists
#subtitle: An aptitude‚Äìtreatment interaction study
format: 
  clean-revealjs:  
    reference-location: document
    self-contained: false
    slide-number: true
    transition: none
    chalkboard: true

   #   buttons: false
 #   preview-links: true
 #   embed-resources: true
#    logo: logo-tilburg-university-long.png
  #  logo: qr.svg
 #   css: lecture.css

filters:
  - highlight-text
  - timer
#  - parse-latex
brand:
  color:
    palette:
      blue: "#0000ff"
      red: "#b22222"
    primary: "#ffffff"  
  
author: 
  - name: Sim√≥n Ruiz
    affiliations: 
      Public University of Navarre (UPNA)
    orcid: 0000-0003-2501-0486
    email: simoneduardo.ruiz@unavarra.es


title-slide-attributes:
    data-background-image: logo_upna.png,  #aesla2024_qr.svg
#    data-background-size: 250px, 600px, 100px,600px, cover
    data-background-size: 13%, 10%, 5%, 5%, cover
    data-background-position: "7% 5%, 90% 60%" 

include-in-header: 
      text: |
        <style>
        .center-xy {
          margin: 0;
          position: absolute;
          top: 30%;
            -ms-transform: translateY(-50%), translateX(-50%);
          transform: translateY(-50%), translateX(-50%);
          font-size:180%; 
          white-space:nowrap;
        }
        </style>
        <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js""></script>
          <script type="text/javascript">
            $(document).ready(function() {
              $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
              // onClick function for all plots (img's)
              $('img:not(.zoomImg)').click(function() {
                $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
                $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
              });
              // onClick function for zoomImg
              $('img.zoomImg').click(function() {
                $('.zoomDiv').css({opacity: '0', width: '0%'}); 
              });
            });
          </script>

bibliography: myref_pres.bib
csl: apa.csl
#footer: Mixed-Effects
date: 01/17/2025
editor: 
  markdown: 
   wrap: 72
---

## 

::: {.center-xy style="top:-10%"}
[What is your]{.fg style="--col: #1f78b4"} [quest]{fg="#FFFFFF"
bg="#1f78b4"}?
:::

:::: {.aling_fig_cap layout-valign="top" style="margin: 4em;text-align: center"}
::: {.content-visible when-format="html"}
![[Monty Python and the Holy Grail
(1975)](https://www.facebook.com/watch/?v=1333699950382729)](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExMTl4a2pndjI5eHllbXhqM3YxdG9kaG9icGQxenR5dmFqMDhibDVkNyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/TayI4SCiq0dJ6/giphy.gif){width="50%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

##  {visibility="hidden"}

:::: center-xy
[What is your]{.fg style="--col: #1f78b4"} [quest]{fg="#FFFFFF"
bg="#1f78b4"}?

::: {#small_font .small_font style="font-size:50%"}
Let's watch this clip from [Monty Python and the Holy Grail
(1975)](https://www.facebook.com/watch/?v=1333699950382729)
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Monty Python {visibility="hidden"}

::: incremental
-   ‚ÄúWhat is the [airspeed velocity]{.fg style="--col: #1f78b4"} of an
    unladen [swallow]{.fg style="--col: #1f78b4"}?‚Äù
    -   [32.4
        kph](https://interestingengineering.com/science/monty-python-and-the-holy-grail-airspeed-velocity-of-an-unladen-swallow)
:::

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align:center;"}
![[Source:
Wikipedia](https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Landsvale.jpg/1024px-Landsvale.jpg)](./img/swallow_bird.jpeg){fig-align="center"
width="50%" height="50%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Preliminary questions

::: {.fragment .semi-fade-out fragment-index="1"}
-   What is your [quest]{.fg style="--col: #1f78b4"}? üòÄ
    -   What is/are your [research question]{.fg
        style="--col: #1f78b4"}/s?
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   What [type of data]{.fg style="--col: #1f78b4"} are you going to
    collect/have collected?
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
-   How do you [plan]{.fg style="--col: #1f78b4"} to [analyze]{.fg
    style="--col: #1f78b4"} your data?
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## What is [our]{colour="#FFFFFF" bg-colour="#b22222"} quest?

:::: {.aling_fig_cap layout-valign="top" style="margin: auto;text-align: center"}
::: {.content-visible when-format="html"}
![[Monty Python and the Holy Grail
(1975)](https://www.facebook.com/watch/?v=1333699950382729)](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExMTl4a2pndjI5eHllbXhqM3YxdG9kaG9icGQxenR5dmFqMDhibDVkNyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/TayI4SCiq0dJ6/giphy.gif){width="50%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# Our quest {background-color="#40666e"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest

### Background

-   Paradigm [shift]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} Two
    [seminal]{.fg style="--col: #1f78b4"} papers ([2008]{.fg
    style="--col: #1f78b4"})

::: {.quarto_figure .important style="margin-top:-0.5em"}
![](./img/papers_1.png){width="75%" height="10%" fig-align="center"}
:::

## Our quest

### Background

-   Paradigm [shift]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} Two
    [seminal]{.fg style="--col: #1f78b4"} papers ([2008]{.fg
    style="--col: #1f78b4"})

::: {.quarto_figure .important style="margin-top:-0.5em"}
![](./img/papers_2.png){width="75%" height="10%" fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest

### Background

-   [Prof. Harald
    Baayen](https://uni-tuebingen.de/en/faculties/faculty-of-humanities/departments/modern-languages/department-of-linguistics/chairs/quantitative-linguistics/staff/harald-baayen/)
    (my regression modeling [teacher]{.fg style="--col: #1f78b4"}! üòÄ)

::: {.quarto_figure .important style="margin-top:"}
![](./img/baayen.jpeg){width="35%" height="%" fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest

### Background

-   [Mixed-effects models]{fg="#FFFFFF" bg="#1f78b4"} have become
    [increasingly]{.fg style="--col: #1f78b4"} [common]{fg="#FFFFFF"
    bg="#1f78b4"} in <br> applied linguistics [@Gries-21]

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest

### Background

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Mixed-effects models]{fg="#FFFFFF" bg="#1f78b4"} have become
    [increasingly]{.fg style="--col: #1f78b4"} [common]{fg="#FFFFFF"
    bg="#1f78b4"} in <br> applied linguistics [@Gries-21]
    -   Powerful, [state-of-the-art]{fg="#FFFFFF" bg="#1f78b4"}
        statistical tools
        -   Improve [accuracy]{.fg style="--col: #1f78b4"} and
            [generalizability]{.fg style="--col: #1f78b4"} of our
            analyses
        -   Enhance our ability to model [real-world]{.fg
            style="--col: #1f78b4"} scenarios
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
[Yet]{fg="#FFFFFF" bg="#da291c"}, many researchers are still
[not]{fg="#FFFFFF" bg="#da291c"} comfortable using them
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest

### Workshop's aims

::: {.fragment .semi-fade-out fragment-index="1"}
-   To [become]{.fg style="--col: #1f78b4"} [familiar]{fg="#FFFFFF"
    bg="#1f78b4"} with mixed-effects models
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   To learn [how]{.fg style="--col: #1f78b4"} to implement them using
    [easy-to-use]{fg="#FFFFFF" bg="#1f78b4"} statistical software
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest

### Workshop's aims

::: {.fragment .semi-fade-out fragment-index="1"}
1.  To offer an [accessible]{.fg style="--col: #1f78b4"}
    [introduction]{fg="#FFFFFF" bg="#1f78b4"} to [mixed-effects
    models]{.fg style="--col: #1f78b4"} in linguistics
:::

:::: {.fragment .fade-in-then-semi-out fragment-index="1"}
2.  To provide a [practical]{fg="#FFFFFF" bg="#1f78b4"} introduction to
    running mixed-effects models:
    -   Free, open-source statistical software [‚Üí]{.alert}
        [[JASP]{fg="#FFFFFF" bg="#4C9FDD"}](https://jasp-stats.org)

::: {.quarto_figure .important style="margin-top:-0.5em"}
![](./img/JASP.png){width="75%" height="10%" fig-align="center"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Our quest {visibility="hidden"}

### Workshop's aims

::: {style="opacity: 0.50;"}
1.  To offer an [accessible]{fg="#FFFFFF" bg="#1f78b4"} introduction to
    [mixed-effects models]{.fg style="--col: #1f78b4"} in linguistics
:::

2.  To provide a [practical]{fg="#FFFFFF" bg="#1f78b4"} introduction to
    running mixed-effects models:
    -   Free, open-source statistical software [‚Üí]{.alert}
        [[jamovi](https://www.jamovi.org)]{fg="#FFFFFF" bg="#496BA4"}

::: {.quarto_figure .important style="margin-top:-0.5em"}
![](./img/jamovi.png){width="70%" height="5%" fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Workshop content

::: {.fragment .semi-fade-out fragment-index="1"}
I. Statistical [modeling]{.fg style="--col: #1f78b4"}

-   The [General]{.fg style="--col: #1f78b4"} Linear Model
-   [Mixed-effects]{.fg style="--col: #1f78b4"} models
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
II\. Mixed-effects modeling in [action]{.fg style="--col: #1f78b4"}:

-   [JASP]{.fg style="--col: #4C9FDD"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# Part I: Statistical Modeling {background-color="#40666e"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### Have you ever seen this before?

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: ;"}
![[Source: University of
Basel](https://tales.nmc.unibas.ch/de/conducting-psychological-research-6/statistics-and-analyses-22/which-test-for-which-hypothesis-71)](./img/which_test_flowchart_1.png){fig-align="center"
width="85%" height="%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### How about [this]{.fg style="color: #1f78b4; font-size: 1.5em"}?

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: ;"}
![[Source: Colorado State
University](https://onishlab.colostate.edu/wp-content/uploads/2019/07/which_test_flowchart.png)](./img/which_test_flowchart_2.png){fig-align="center"
width="%" height="%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### And [this]{.fg style="color: #1f78b4; font-size: 1.6em"}?

:::: {.regression_graph_1 .important style="margin-top:-0.8em"}
::: {.captions-fig style="text-align: ;"}
![[Decision tree. Source:
JASP]()](./img/decision_tree.png){fig-align="center" width="75%"
height="%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### Traditional: [Testing]{.fg style="color: #1f78b4; font-size: 1.6em"}-based approach

:::: {.regression_graph_1 .important style="margin-top:-0.8em"}
::: {.captions-fig style="text-align: ;"}
![[Decision tree. Source:
JASP]()](./img/decision_tree.png){fig-align="center" width="75%"
height="%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## 

:::: {.center-xy style="font-size:130%;"}
"[Life]{.fg style="--col: #1f78b4"} is really [simple]{fg="#FFFFFF"
bg="#1f78b4"}, but we insist on making it complicated."

::: {.small_font style="font-size:60%"}
‚ÄìConfucius
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# Model-based approach {background-color="#40666e"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### What is a statistical model?

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Representation]{fg="#FFFFFF" bg="#1f78b4"} of reality
    -   Mathematical [representation]{.fg style="--col: #1f78b4"} of
        [data generating process]{.fg style="--col: #1f78b4"} <br>
        [@Field.Field.ea-12]
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   Used to make [predictions]{fg="#FFFFFF" bg="#1f78b4"} about
    real-world phenomenon
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
-   Must [represent]{.fg style="--col: #1f78b4"} the data collected
    ([observed]{.fg style="--col: #1f78b4"}) as closely as possible
    -   To [reduce errors]{fg="#FFFFFF" bg="#1f78b4"} in prediction
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
-   The [closer]{fg="#FFFFFF" bg="#1f78b4"} the model represents the
    data collected
    -   The [better]{fg="#FFFFFF" bg="#1f78b4"} the [fit]{fg="#FFFFFF"
        bg="#1f78b4"} of the model
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### What is a statistical model?

::: incremental
-   [All]{fg="#FFFFFF" bg="#1f78b4"} statistical procedures
    -   Essentially the [same]{fg="#FFFFFF" bg="#1f78b4"} model
    -   Variations of this [basic]{fg="#FFFFFF" bg="#1f78b4"} model:
:::

:::: {.fragment .fade-in-then-semi-out}
::: r-stack
Outcome = ([Model]{fg="#FFFFFF" bg="#1f78b4"}) + Error
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### Example of a statistical model

::: incremental
-   [Simple]{.fg style="--col: #1f78b4"} statistical model [‚Üí]{.alert}
    [Mean]{.fg style="--col: #1f78b4"}
    -   [Hypothetical]{.fg style="--col: #1f78b4"} value [‚Üí]{.alert}
        [Doesn't]{.fg style="--col: #1f78b4"} have to be observed in the
        data
    -   Model ([prediction]{.fg style="--col: #1f78b4"}) [‚Üí]{.alert}
        [Mean]{.fg style="--col: #1f78b4"} value used to [summarize]{.fg
        style="--col: #1f78b4"} the data
:::

::: r-stack
Outcome = [Mean]{fg="#FFFFFF" bg="#1f78b4"} + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### Example of a statistical model

-   [Simple]{.fg style="--col: #1f78b4"} statistical model [‚Üí]{.alert}
    [Mean]{.fg style="--col: #1f78b4"}
    -   [Hypothetical]{.fg style="--col: #1f78b4"} value [‚Üí]{.alert}
        [Doesn't]{.fg style="--col: #1f78b4"} have to be observed in the
        data
    -   Model ([prediction]{.fg style="--col: #1f78b4"}) [‚Üí]{.alert}
        [Mean]{.fg style="--col: #1f78b4"} value used to [summarize]{.fg
        style="--col: #1f78b4"} the data

::: r-stack
Outcome~[*i*]{.fg style="--col: #31a354"}~ = [Mean]{fg="#FFFFFF"
bg="#1f78b4"} + Error~[*i*]{.fg style="--col: #de2d26"}~
:::

::: r-stack
~[*i*]{.fg style="--col: #31a354"}~ = Associated with an individual
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Introduction

### Example of a statistical model

-   [Simple]{.fg style="--col: #1f78b4"} statistical model [‚Üí]{.alert}
    [Mean]{.fg style="--col: #1f78b4"}
    -   [Hypothetical]{.fg style="--col: #1f78b4"} value [‚Üí]{.alert}
        [Doesn't]{.fg style="--col: #1f78b4"} have to be observed in the
        data
    -   Model ([prediction]{.fg style="--col: #1f78b4"}) [‚Üí]{.alert}
        [Mean]{.fg style="--col: #1f78b4"} value used to [summarize]{.fg
        style="--col: #1f78b4"} the data

::: r-stack
Outcome~[*student¬†1*]{.fg style="--col: #31a354"}~ = [Mean]{fg="#FFFFFF"
bg="#1f78b4"} + Error~[*student¬†1*]{.fg style="--col: #de2d26"}~
:::

::::: {.fragment .fade-in-then-semi-out}
:::: r-stack
::: {style="margin-left: 44.2%; margin-top: -2%;"}
[2]{.fg style="--col: #31a354"} = [5.1]{.fg style="--col: #1f78b4"} +
Error~[*student¬†1*]{.fg style="--col: #da291c"}~
:::
::::
:::::

::::: {.fragment .fade-in-then-semi-out}
:::: r-stack
::: {style="margin-left: 44.2%; margin-top: -2%;"}
[2]{.fg style="--col: #31a354"} = [5.1]{.fg style="--col: #1f78b4"} +
([2]{.fg style="--col: #31a354"} - [5.1]{.fg style="--col: #1f78b4"} =
[-3.1]{.fg style="--col: #da291c"})
:::
::::
:::::

::::: {.fragment .fade-in-then-semi-out}
:::: r-stack
::: {style="margin-left: 44.2%; margin-top: -2%;"}
[2]{.fg style="--col: #31a354"} = [5.1]{.fg style="--col: #1f78b4"} + =
[-3.1]{.fg style="--col: #da291c"} [‚Üí]{.alert} Deviation ([residual]{.fg
style="--col: #da291c"})
:::
::::
:::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# The General Linear Model {background-color="#40666e"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

::: {.fragment .fade-in-then-semi-out}
-   [Predicting]{.fg style="--col: #1f78b4"} an [outcome]{.fg
    style="--col: #1f78b4"} (response) variable from one or more
    [predictors]{.fg style="--col: #1f78b4"}
:::

::: incremental
-   The [General Linear Model]{colour="#FFFFFF" bg-colour="#da291c"}
    -   [Linear]{.fg style="--col: #1f78b4"}: [Straight
        line]{colour="#FFFFFF" bg-colour="#da291c"} that
        [summarizes]{.fg style="--col: #1f78b4"} the data
    -   [Model]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} ['Things']{.fg
        style="--col: #1f78b4"} that define the [line]{.fg
        style="--col: #da291c"} [@Field.Field.ea-12]
:::

::::: {.fragment .fade-in}
:::: {#captions .captions-fig style="text-align: center;"}
::: {.regression_graph_1 .important style="margin-top: -0.5em"}
![Adapted from @Gonick.Smith.ea-93 [p.
188]](./img/cartoon_regression_line.png){fig-align="center" width="40%"
height="40%"}
:::
::::
:::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

:::: {style="opacity: 0.50;"}
::: nonincremental
-   [Predicting]{.fg style="--col: #1f78b4"} an [outcome]{.fg
    style="--col: #1f78b4"} (response) variable from one or more
    [predictors]{.fg style="--col: #1f78b4"}
:::
::::

::: incremental
-   [Model]{.fg style="--col: #1f78b4"} to be fit [‚Üí]{.alert}
    [Linear]{colour="#FFFFFF" bg-colour="#1f78b4"}
    -   [Linear]{.fg style="--col: #1f78b4"}: A [straight line]{.fg
        style="--col: #da291c"} that [summarizes]{.fg
        style="--col: #1f78b4"} the data
    -   [Model]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} ['Things']{.fg
        style="--col: #1f78b4"} that define the [line]{.fg
        style="--col: #da291c"} [@Field.Field.ea-12]
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

::::: {style="opacity: 0.50;"}
::: nonincremental
-   [Predicting]{.fg style="--col: #1f78b4"} an [outcome]{.fg
    style="--col: #1f78b4"} (response) variable from one or more
    [predictors]{.fg style="--col: #1f78b4"}
:::

::: nonincremental
-   [Model]{.fg style="--col: #1f78b4"} to be fit [‚Üí]{.alert}
    [Linear]{colour="#FFFFFF" bg-colour="#1f78b4"}
    -   [Linear]{.fg style="--col: #1f78b4"}: A [straight line]{.fg
        style="--col: #da291c"} that [summarizes]{.fg
        style="--col: #1f78b4"} the data
    -   [Model]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} ['Things']{.fg
        style="--col: #1f78b4"} that define the [line]{.fg
        style="--col: #da291c"} [@Field.Field.ea-12]
:::
:::::

::: r-stack
Outcome = ([Model]{colour="#FFFFFF" bg-colour="#1f78b4"}) + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

::::: {style="opacity: 0.50;"}
::: nonincremental
-   [Predicting]{.fg style="--col: #1f78b4"} an [outcome]{.fg
    style="--col: #1f78b4"} (response) variable from one or more
    [predictors]{.fg style="--col: #1f78b4"}
:::

::: nonincremental
-   [Model]{.fg style="--col: #1f78b4"} to be fit [‚Üí]{.alert}
    [Linear]{colour="#FFFFFF" bg-colour="#1f78b4"}
    -   [Linear]{.fg style="--col: #1f78b4"}: A [straight line]{.fg
        style="--col: #da291c"} that [summarizes]{.fg
        style="--col: #1f78b4"} the data
    -   [Model]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} ['Things']{.fg
        style="--col: #1f78b4"} that define the [line]{.fg
        style="--col: #da291c"} [@Field.Field.ea-12]
:::
:::::

:::: r-stack
::: {style="margin-left: 33%; margin-top: -1%;"}
Outcome = [Linear]{colour="#FFFFFF" bg-colour="#1f78b4"} predictor(s) +
Error
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Which line best describes the data collected?

:::: {.regression_graph_1 .important style="margin-top: -.5em"}
::: {.captions-fig style="text-align: center;"}
![Taken from @Gonick.Smith.ea-93 [p.
189]](./img/cartoon_fitting.png){fig-align="center" width="50%"
height="50%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

::: incremental
-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
    [Single]{fg="#FFFFFF " bg="#31a354"} line that [best]{.fg
    style="--col: #1f78b4"} fits the data
    -   Has the [smallest]{.fg style="--col: #1f78b4"} overall
        [distance]{.fg style="--col: #1f78b4"} from the line to the
        points
    -   Indicates [strength]{.fg style="--col: #1f78b4"} and
        [direction]{.fg style="--col: #1f78b4"} of [association]{.fg
        style="--col: #1f78b4"} among variables
:::

:::: {.fragment .fade-in}
::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::
::::
```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
    [Predictive]{.fg style="--col: #1f78b4"} or [explanatory]{.fg
    style="--col: #1f78b4"} use

    -   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{fg="#FFFFFF" bg="#1f78b4"}
    -   [[Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Rate]{.fg
        style="--col: #da291c"} of [change]{.fg style="--col: #da291c"}]{.fg style="opacity: 0.2"}

::: r-stack
Outcome = [Intercept]{fg="#FFFFFF" bg="#1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
    [Predictive]{.fg style="--col: #1f78b4"} or [explanatory]{.fg
    style="--col: #1f78b4"} use

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{.fg style="--col: #1f78b4"}]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Rate of
        change]{fg="#FFFFFF " bg="#da291c"}

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
    [Predictive]{.fg style="--col: #1f78b4"} or [explanatory]{.fg
    style="--col: #1f78b4"} use

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{.fg style="--col: #1f78b4"}]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert}
        [Change]{fg="#FFFFFF " bg="#da291c"} in predictor: [Associated]{.fg style="--col: #1f78b4"} with a
        [change]{fg="#FFFFFF " bg="#da291c"} in outcome

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{.fg style="--col: #1f78b4"} ([Continuous]{fg="#FFFFFF"
    bg="#998ec3"} predictors)

    -   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{fg="#FFFFFF" bg="#1f78b4"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean of outcome]{fg="#FFFFFF"
        bg="#1f78b4"} when predictor(s) = [0]{.fg
        style="--col: #1f78b4"}
    -   [[Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [One-unit
        change]{.fg style="--col: #da291c"} in outcome, on [average]{.fg
        style="--col: #da291c"}]{.fg style="opacity: 0.2"}

::: r-stack
Outcome = [Intercept]{fg="#FFFFFF" bg="#1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{.fg style="--col: #1f78b4"} ([Continuous]{fg="#FFFFFF"
    bg="#998ec3"} predictors)

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{.fg style="--col: #1f78b4"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean]{.fg style="--col: #1f78b4"} of
        outcome when predictor(s) = [0]{.fg style="--col: #1f78b4"}]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [One-unit
        change]{fg="#FFFFFF " bg="#da291c"} in outcome, on [average]{.fg
        style="--col: #da291c"}

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{.fg style="--col: #1f78b4"} ([Categorical]{fg="#FFFFFF"
    bg="#f1a340"} predictors)

    -   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{fg="#FFFFFF" bg="#1f78b4"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean of reference group]{fg="#FFFFFF"
        bg="#1f78b4"} (coded = [0]{.fg style="--col: #1f78b4"})
    -   [[Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [One-unit
        change]{.fg style="--col: #da291c"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean difference]{.fg
        style="--col: #da291c"} (coded = [1]{.fg
        style="--col: #da291c"})]{.fg style="opacity: 0.2"}

::: r-stack
Outcome = [Intercept]{fg="#FFFFFF" bg="#1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{.fg style="--col: #1f78b4"} ([Categorical]{fg="#FFFFFF"
    bg="#f1a340"} predictors)

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{.fg style="--col: #1f78b4"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean]{.fg style="--col: #1f78b4"} of
        [reference]{.fg style="--col: #1f78b4"} group (coded = [0]{.fg
        style="--col: #1f78b4"})]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [One-unit
        change]{fg="#FFFFFF " bg="#da291c"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean difference]{fg="#FFFFFF "
        bg="#da291c"} (coded = [1]{.fg style="--col: #da291c"})

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{.fg style="--col: #1f78b4"} ([Categorical]{fg="#FFFFFF"
    bg="#f1a340"} predictors)

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{.fg style="--col: #1f78b4"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Mean]{.fg style="--col: #1f78b4"} of
        [reference]{.fg style="--col: #1f78b4"} group (coded = [0]{.fg
        style="--col: #1f78b4"})]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [One-unit
        change]{fg="#FFFFFF " bg="#da291c"} [‚üπ]{.fg
        style="--col: #1f78b4"} [Switching]{fg="#FFFFFF " bg="#da291c"}
        from one category to the other

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{fg="#FFFFFF " bg="#31a354"} ([coefficients]{.fg
    style="--col: #1f78b4"})

    -   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{fg="#FFFFFF" bg="#1f78b4"} [‚üπ]{.alert} [b~0~]{.fg
        style="--col: #1f78b4"} = [beta zero]{fg="#FFFFFF" bg="#1f78b4"}
        (X = [0]{.fg style="--col: #1f78b4"})
    -   [[Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Rate of
        change]{.fg style="--col: #da291c"} [‚üπ]{.alert} [b~1~]{.fg
        style="--col: #da291c"} = [beta one]{.fg style="--col: #da291c"}]{.fg style="opacity: 0.2"}

::: r-stack
Outcome = [Intercept]{fg="#FFFFFF" bg="#1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::

:::: r-stack
::: {style="margin-left: 29.5%; margin-top: -2%;"}
Y = [b~0~]{fg="#FFFFFF" bg="#1f78b4"} + [b~1~]{.fg
style="--col: #da291c"}\* X + Œµ
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{fg="#FFFFFF " bg="#31a354"} ([coefficients]{.fg
    style="--col: #1f78b4"})

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
        [Baseline]{.fg style="--col: #1f78b4"} [‚üπ]{.alert} [b~0~]{.fg
        style="--col: #1f78b4"} = [beta zero]{.fg
        style="--col: #1f78b4"} (X = [0]{.fg style="--col: #1f78b4"})]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Rate of
        change]{fg="#FFFFFF " bg="#da291c"} [‚üπ]{.alert} [b~1~]{.fg
        style="--col: #da291c"} = [beta one]{fg="#FFFFFF " bg="#da291c"}

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

:::: r-stack
::: {style="margin-left: 29.5%; margin-top: -2%;"}
Y = [b~0~]{.fg style="--col: #1f78b4"} + [b~1~]{fg="#FFFFFF "
bg="#da291c"}\* X + Œµ
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{fg="#FFFFFF " bg="#31a354"} ([coefficients]{.fg
    style="--col: #1f78b4"})

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} [Predictor
        value]{.fg style="--col: #1f78b4"} = [0]{.fg
        style="--col: #1f78b4"} (zero)]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [The effect of
        the predictor]{fg="#FFFFFF " bg="#da291c"} on the outcome

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

:::: r-stack
::: {style="margin-left: 29.5%; margin-top: -2%;"}
Y = [b~0~]{.fg style="--col: #1f78b4"} + [b~1~]{fg="#FFFFFF "
bg="#da291c"}\* X + Œµ
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{fg="#FFFFFF " bg="#31a354"} ([coefficients]{.fg
    style="--col: #1f78b4"})

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} [Predictor
        value]{.fg style="--col: #1f78b4"} = [0]{.fg
        style="--col: #1f78b4"} (zero)]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Effect
        size]{fg="#FFFFFF " bg="#da291c"}

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

:::: r-stack
::: {style="margin-left: 29.5%; margin-top: -2%;"}
Y = [b~0~]{.fg style="--col: #1f78b4"} + [b~1~]{fg="#FFFFFF "
bg="#da291c"}\* X + Œµ
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

-   [Regression line]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Regression
    [estimates]{fg="#FFFFFF " bg="#31a354"} ([coefficients]{.fg
    style="--col: #1f78b4"})

    -   [[Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} [Predictor
        value]{.fg style="--col: #1f78b4"} = [0]{.fg
        style="--col: #1f78b4"} (zero)]{.fg style="opacity: 0.2"}
    -   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Effect
        size]{.fg style="--col: #da291c"}: [Direction]{fg="#FFFFFF "
        bg="#da291c"} and [magnitude]{fg="#FFFFFF " bg="#da291c"} of
        effect

::: r-stack
Outcome = [Intercept]{.fg style="--col: #1f78b4"} +
[Slope]{fg="#FFFFFF " bg="#da291c"} \* predictor + Error
:::

:::: r-stack
::: {style="margin-left: 29.5%; margin-top: -2%;"}
Y = [b~0~]{.fg style="--col: #1f78b4"} + [b~1~]{fg="#FFFFFF "
bg="#da291c"}\* X + Œµ
:::
::::


```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Regression line

::: {.regression_graph_1 .important style="margin-top: -2em"}
![](./img/correlation.png){fig-align="center" width="60%" height="60%"}
:::

## Linear regression

### Regression line

::: {.regression_graph_1 .important style="margin-top: -2em"}
![](./img/regression_line.png){fig-align="center" width="60%"
height="60%"}
:::

## Linear regression

### Regression line

::: {.regression_graph_1 .important style="margin-top: -2em"}
![](./img/regression_line1.png){fig-align="center" width="60%"
height="60%"}
:::

## Linear regression

### Regression line

::: {.regression_graph_1 .important style="margin-top: -2em"}
![](./img/regression_line2.png){fig-align="center" width="60%"
height="60%"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Model fit: Sum of squared errors (SSE)

:::: {.regression_graph_1 .important style="margin-top: 0em"}
::: {.captions-fig style="text-align: center;"}
![Adapted from @Gonick.Smith.ea-93 [p.
193]](./img/cartoon_sum_squared_errors.png){fig-align="center"
width="50%" height="50%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Model fit: Sum of squared errors (SSE)

:::: {.regression_graph_1 .important style="margin-top: -.5em"}
::: {.captions-fig style="text-align: center;"}
![Adapted from @Gonick.Smith.ea-93 [p.
193]](./img/cartoon_different_fit_1.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Model fit: Sum of squared errors (SSE)

:::: {.regression_graph_1 .important style="margin-top: -.5em"}
::: {.captions-fig style="text-align: center;"}
![Adapted from @Gonick.Smith.ea-93 [p.
193]](./img/cartoon_different_fit_2.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Model fit: Sum of squared errors (SSE)

:::: {.regression_graph_1 .important style="margin-top: -.5em"}
::: {.captions-fig style="text-align: center;"}
![Adapted from @Gonick.Smith.ea-93 [p.
193]](./img/cartoon_different_fit_3.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Model fit: Sum of squared errors (SSE)

:::: {.regression_graph_1 .important style="margin-top: -.5em"}
::: {.captions-fig style="text-align: center;"}
![Adapted from @Gonick.Smith.ea-93 [p.
193]](./img/cartoon_different_fit_4.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Basic modeling assumptions

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Linearity]{.fg style="--col: #1f78b4"}
    -   [Linear relationship]{.fg style="--col: #1f78b4"} between
        outcome and predictors ([constant]{fg="#FFFFFF" bg="#1f78b4"}
        change)
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Normality]{.fg style="--col: #1f78b4"}
    -   Errors ([not variables!]{.fg style="--col: #1f78b4"})
        [‚Üí]{.alert} [Normally]{.fg style="--col: #1f78b4"} distributed
        ![](img/normal.png){fig-align="left"
        style="float:right;margin: -30px -20px 0px 0px; " width="7%"}
        ([least]{colour="#FFFFFF" bg-colour="#da291c"} important)
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
-   [Equal]{.fg style="--col: #1f78b4"} variance (Homoskedasticity)
    -   Errors ([residuals]{.fg style="--col: #1f78b4"}) [‚Üí]{.alert}
        [Constant]{fg="#FFFFFF" bg="#1f78b4"} variance (i.e.,
        [variability]{.fg style="--col: #1f78b4"})
:::

::: {.fragment .fade-in fragment-index="5"}
-   [Independence]{colour="#FFFFFF" bg-colour="#31a354"}
    -   Errors ([residuals]{.fg style="--col: #1f78b4"}) [‚Üí]{.alert}
        [Independent]{.fg style="--col: #1f78b4"} (i.e.,
        [uncorrelated]{fg="#FFFFFF" bg="#1f78b4"}):
        [Fundamental]{colour="#FFFFFF" bg-colour="#31a354"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Linear regression

### Clear violations of (a) constant variance and (b) normality

:::: {.regression_graph_1 .important style="margin-top: -.8em"}
::: {.captions-fig style="text-align: center;"}
![Taken from @Winter-19 [p.
75]](./img/assumptions_residuals.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## 

::::: center-xy
::: {.small_font style="font-size:75%"}
"[Statistics]{.fg style="--col: #1f78b4"} is about finding the right
([most useful]{fg="#FFFFFF " bg="#1f78b4"}) model.
:::

::: {.small_font style="font-size:50%"}
‚Äì@QuantPsych-24
:::
:::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# Generalized Linear Model {background-color="#40666e"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Overview of Generalized Linear Model (GLM)

::: {.model_types .important style="max-width:130%"}
![](./img/model_types_0.png){fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Overview of Generalized Linear Model (GLM)

::: {.model_types .important style="max-width:130%"}
![](./img/model_types_1.png){fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Overview of Generalized Linear Model (GLM)

::: {.model_types .important style="max-width:130%"}
![](./img/model_types_2.png){fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Overview of Generalized Linear Model (GLM)

::: {.model_types .important style="max-width:130%"}
![](./img/model_types_3.png){fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Overview of Generalized Linear Model (GLM)

::: {.model_types .important style="max-width:130%"}
![](./img/model_types_4.png){fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Overview of Generalized Linear Model (GLM)

:::: {.model_types .important style="max-width:130%"}
::: {.captions-fig style="font-size:50%;"}
![Adapted from [UCLA Office of Advanced Research Computing
(OARC)](https://stats.oarc.ucla.edu/wp-content/uploads/2022/03/generalized_linear_new.html#(4))](./img/model_types_5.png){fig-align="center"}
:::
::::

## Overview of Generalized Linear Model (GLM)

:::: {.model_types .important style="max-width:130%"}
::: {.captions-fig style="font-size:50%;"}
![Adapted from [UCLA Office of Advanced Research Computing
(OARC)](https://stats.oarc.ucla.edu/wp-content/uploads/2022/03/generalized_linear_new.html#(4))](./img/model_types_6.png){fig-align="center"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Pair work

-   Formulate a [question]{.fg style="--col: #1f78b4"} about what we
    have seen so far

::: {#Timer1 .timer seconds="120" starton="interaction" style="float: right; margin-top: 2em"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# [Your questions]{.fg style="--col: #1f78b4"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.small_font style="font-size:85%"}
# [Why]{fg="#FFFFFF " bg="#1f78b4"} [do we need]{.fg style="--col: #1f78b4"} [mixed models]{.fg style="--col: #1f78b4"}?
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.text_size .important style="white-space:nowrap; font-size:75%"}
# Making the case: Mixed-effects modeling {background-color="#40666e"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: Research question (our quest)

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?[^1]

[^1]: Adapted from [Brown
    (2021)](https://youtu.be/3OFXxh4yORU?si=m9fKqHB5hWj4pif9)

::: {.fragment .fade-in fragment-index="1"}
```{r}
# Packages ---------------------------------------------------------------
# Load libraries
library(tidyverse)

# Import functions
source("src/helper.R")

# For overlapping text in graph
library(grid)
library(gridExtra)

library(showtext)

# Google fonts for presentation graphics
# https://fonts.google.com/featured/Superfamilies
 font_add_google("Nunito", "Nunito")
 font_add_google("Nunito", "Nunito")
 showtext_auto()


##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                                    Data                                  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

df <- read.csv("data/df_skipping.csv", 
    header = TRUE) 

 
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                                   Graphs                                 ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 1: No regression line  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Plot the data with a regression line for all classes combined
graph_one <- ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(), alpha = 0.6) +  # Scatter plot for data points
  #  geom_smooth(method = "lm", 
  #      se = TRUE, 
  #      color = "black", 
   #     linewidth = 1.5) +  # Regression line for all data
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()

# To see resulting graph
#graph_one 

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_one <- arrangeGrob(
    graph_one,
    top = title.grob
)

grid.draw(graph_one)


```
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: One overall regression line (standard regression)

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 2: Overall regression line  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined
graph_two <- ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(), alpha = 0.6) +  # Scatter plot for data points
    geom_smooth(method = "lm", 
        se = TRUE, 
        color = "#1f78b4", 
        linewidth = 1.5) +  # Regression line for all data
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()

# To see resulting graph
#graph_two 

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_two <- arrangeGrob(
    graph_two,
    top = title.grob
)

grid.draw(graph_two)


```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: One overall regression line (standard regression)

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Skipping class]{.fg style="--col: #1f78b4"}
    [negatively]{fg="#FFFFFF" bg="#1f78b4"} affect
    grades`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 2: Overall regression line  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined
graph_two <- ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(), alpha = 0.6) +  # Scatter plot for data points
    geom_smooth(method = "lm", 
        se = TRUE, 
        color = "#1f78b4", 
        linewidth = 1.5) +  # Regression line for all data
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()

# To see resulting graph
#graph_two 

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_two <- arrangeGrob(
    graph_two,
    top = title.grob
)

grid.draw(graph_two)


```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: By-class regression lines

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: By-class regression lines

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Effect]{.fg style="--col: #1f78b4"} of skipping class may
    [depend]{fg="#FFFFFF" bg="#1f78b4"} on class`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: By-class regression lines

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Class 1]{fg="#FFFFFF" bg="#E69F00"} (lectures & materials all
    available online) [‚Üí]{.alert} [No]{fg="#FFFFFF" bg="#E69F00"}
    correlation`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: By-class regression lines

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Class 2]{fg="#FFFFFF" bg="#009E73"} (some materials online)
    [‚Üí]{.alert} [Negative]{fg="#FFFFFF" bg="#009E73"}
    correlation`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: By-class regression lines

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Class 3]{fg="#FFFFFF" bg="#0072B2"} (nothing online) [‚Üí]{.alert}
    [Large negative]{fg="#FFFFFF" bg="#0072B2"}
    correlation`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: One overall regression line (standard regression)

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   Which [assumption]{fg="#FFFFFF" bg="#1f78b4"} is being
    violated?`r gen_fn(1, "fn1")`

```{r}

library(ggpubr)
library(gridGraphics)

#| fig-width: 10
#| fig-height: 5

# Arrange them next to each other
ggarrange(
  graph_two, graph_three, 
  ncol = 2
  )


```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: One overall regression line (standard regression)

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Independence]{colour="#FFFFFF" bg-colour="#31a354"} assumption:
    [Why]{.fg style="--col: #1f78b4"}?`r gen_fn(1, "fn1")`

```{r}

library(ggpubr)
library(gridGraphics)

#| fig-width: 10
#| fig-height: 5

# Arrange them next to each other
ggarrange(
  graph_two, graph_three, 
  ncol = 2
  )


```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: One overall regression line (standard regression)

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   [Independence]{colour="#FFFFFF" bg-colour="#31a354"} assumption:
    Observations [within]{.fg style="--col: #1f78b4"} each class
    [‚Üí]{.alert} [Correlated]{colour="#FFFFFF"
    bg-colour="#1f78b4"}`r gen_fn(1, "fn1")`

```{r}

library(ggpubr)
library(gridGraphics)

#| fig-width: 10
#| fig-height: 5

# Arrange them next to each other
ggarrange(
  graph_two, graph_three, 
  ncol = 2
  )


```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Violation of independence assumption

::: incremental
-   Results in [artificially]{.fg style="--col: #1f78b4"} low *p*-values
    [‚Üì]{colour="#FFFFFF" bg-colour="#1f78b4"} ([biased]{colour="#FFFFFF"
    bg-colour="#da291c"})
    -   [Type 1 errors]{colour="#FFFFFF" bg-colour="#da291c"} go
        [‚Üë]{colour="#FFFFFF" bg-colour="#da291c"}
:::

::::: {.fragment .fade-in}
:::: {.regression_graph_1 .important style="margin-top:-.5em"}
::: {.captions-fig style="text-align: center;"}
![[Source:
Economics](https://i.sstatic.net/Kq0OH.jpg)](./img/error_type.jpg){fig-align="center"
width="50%" height="50%"}
:::
::::
:::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Dealing with dependencies in linguistic data

::: {.fragment .fade-in-then-semi-out}
-   [Traditional]{.fg style="--col: #1f78b4"} way of analysis:
    -   Modeling [aggregated]{.fg style="--col: #1f78b4"} data (i.e.,
        [ignoring]{.fg style="--col: #1f78b4"} dependencies)
        -   Standard, [single]{.fg style="--col: #1f78b4"} linear model
            for [all]{.fg style="--col: #1f78b4"} participants
:::

::: incremental
-   [Aggregation]{.fg style="--col: #1f78b4"}
    -   [Means]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Entered into the
        analysis
    -   Subject and item [variability]{fg="#FFFFFF" bg="#1f78b4"}
        [‚Üí]{.alert} [Collapsed]{fg="#FFFFFF" bg="#1f78b4"}
        -   Model [‚Üí]{.alert} Understimates variability (i.e.,
            [Loses]{fg="#FFFFFF" bg="#da291c"} information)
        -   Model [‚Üí]{.alert} Has [less]{fg="#FFFFFF" bg="#da291c"}
            information to work with!
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Data visualization: All data points

```{r}
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 1: No regression line  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Plot the data with a regression line for all classes combined
graph_one <- ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(), alpha = 0.6) +  # Scatter plot for data points
  #  geom_smooth(method = "lm", 
  #      se = TRUE, 
  #      color = "black", 
   #     linewidth = 1.5) +  # Regression line for all data
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()

# To see resulting graph
#graph_one 

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_one <- arrangeGrob(
    graph_one,
    top = title.grob
)

grid.draw(graph_one)


```

## Making the case: Mixed-effects

### Data visualization: Means

```{r}

# Calculate the mean, standard deviation, and count for each group
df_means <- df %>%
  group_by(class) %>%
  summarize(
    mean_value = mean(grade),
    sd_value = sd(grade),
    count = n()
  )

##~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 4: Means  ----
##~~~~~~~~~~~~~~~~~~~~~~~~

# Plot the data with a regression line for all classes combined
graph_four <- ggplot(df, aes(
  x = skipped_proportion, 
  y = grade)
  ) +
  geom_point(aes(), 
    alpha = 0
    ) +  
  geom_point(data = df_means, 
    shape = 23, 
    fill = thematic::okabe_ito(3),
    aes(x = c(.20,.40 , .60), 
      y = mean_value,
     # group = class,
     # color = class,
     # shape = class
      ), 
    size = 4)  + # Manually add the mean points
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
  labs(x = "Proportion of skipped classes") +
#  scale_color_manual(values= thematic::okabe_ito(3)) +
  theme(legend.title = element_blank()) +
  theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_four <- arrangeGrob(
  graph_four,
  top = title.grob
)

grid.draw(graph_four)


```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Aggregated vs. unaggregated data

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Aggregated]{.fg style="--col: #da291c"} data [‚Üí]{.alert} [One]{.fg
    style="--col: #da291c"} data point for [each]{.fg
    style="--col: #da291c"} subject
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Unaggregated]{.fg style="--col: #1f78b4"} data [‚Üí]{.alert}
    [Multiple]{fg="#FFFFFF" bg="#1f78b4"} data points for [each]{.fg
    style="--col: #1f78b4"} subject
:::

:::::: {.fragment .fade-in fragment-index="2"}
::::: {.columns .column-screen-inset}
::: column
[Aggregated]{.fg style="--col: #da291c"} (wide format)

``` {.r code-line-numbers="2|3|4|5|6|7"}
  subject                       Mean_RT
1   S_101                          8.75
2   S_102                          8.42
3   S_103                          8.19
4   S_104                          8.46
5   S_105                          8.64
```
:::

::: column
[Unaggregated]{.fg style="--col: #1f78b4"} ([long]{fg="#FFFFFF"
bg="#1f78b4"} format)

``` {.r code-line-numbers="2|3|4|5|6|7"}
  subject                           RT
1   S_101                         9.59
2   S_101                         8.67
3   S_101                        10.14
4   S_101                         9.55
5   S_101                         9.17
```
:::
:::::
::::::

## Making the case: Mixed-effects

### Summary: Costs of ignoring variability

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Loss]{fg="#FFFFFF" bg="#da291c"} of information:
    -   [Reduction]{.fg style="--col: #da291c"} of [statistical
        power]{.fg style="--col: #1f78b4"} [(i.e., ability to
        ]{style="font-size: 92%;"}[detect]{.fg style="--col: #1f78b4"}
        an [effect]{.fg style="--col: #1f78b4"} if it truly [exists]{.fg
        style="--col: #1f78b4"})
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [*p*-values]{.fg style="--col: #1f78b4"} [‚Üí]{.alert}
    [Artificially]{.fg style="--col: #1f78b4"} low [‚Üì]{colour="#FFFFFF"
    bg-colour="#1f78b4"}
    -   [Increase]{.fg style="--col: #da291c"} of [Type I
        error]{fg="#FFFFFF" bg="#da291c"} rates [‚Üë]{colour="#FFFFFF"
        bg-colour="#da291c"}
    -   [Overstimation]{fg="#FFFFFF" bg="#da291c"} of effects
:::

::: {.fragment .fade-in-then-semi-out}
-   In short:
    -   Our [inferences]{fg="#FFFFFF" bg="#1f78b4"} can be [seriously
        compromised]{.fg style="--col: #da291c"} ([less]{fg="#FFFFFF"
        bg="#da291c"} accurate)
:::

::: {.fragment .fade-in-then-semi-out}
-   [Solution]{fg="#FFFFFF" bg="#1f78b4"}:
    -   [Innovative]{.fg style="--col: #1f78b4"} method [‚Üí]{.alert}
        [Mixed-effects modeling]{fg="#FFFFFF" bg="#1f78b4"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Pair work

-   Formulate a [question]{.fg style="--col: #1f78b4"} about what we
    have seen so far

::: {#Timer2 .timer seconds="120" starton="interaction" style="float: right; margin-top: 2em"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# [Your questions]{.fg style="--col: #1f78b4"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# Mixed-Effects Modeling {background-color="#40666e"}

## Mixed-effects models

### It's all in the name!

::: incremental
-   [Terminology]{.fg style="--col: #1f78b4"}:
    -   [Variance]{.fg style="--col: #1f78b4"} components
    -   [Random]{.fg style="--col: #1f78b4"} intercepts and slopes
    -   [Random]{.fg style="--col: #1f78b4"} effects
    -   [Random]{.fg style="--col: #1f78b4"} coefficients
    -   [Varying]{.fg style="--col: #1f78b4"} coefficients
    -   [Varying]{.fg style="--col: #1f78b4"} intercepts and slopes
    -   [Hierarchical]{.fg style="--col: #1f78b4"} linear models
    -   [Multilevel]{.fg style="--col: #1f78b4"} models ([implies
        multiple levels of]{style="font-size: 97%;"} [hierarchically
        clustered]{.fg style="--col: #1f78b4"} data)
    -   [Mixed effects models]{fg="#FFFFFF" bg="#1f78b4"}
:::

## Mixed-effects models

### What they are

::: {.fragment .fade-in-then-semi-out}
-   [Extension]{fg="#FFFFFF" bg="#1f78b4"} of traditional regression
    -   But can [incorporate]{.fg style="--col: #1f78b4"} all kinds of
        [dependencies]{.fg style="--col: #1f78b4"} into the analysis
:::

::: incremental
-   Examples of [nesting]{colour="#FFFFFF" bg-colour="#1f78b4"} and
    [dependencies]{.fg style="--col: #1f78b4"}:
    -   Students [within]{.fg style="--col: #1f78b4"} classes
        ([within]{.fg style="--col: #1f78b4"} schools)
    -   Observations [within]{.fg style="--col: #1f78b4"} people (e.g.,
        [longitudinal]{.fg style="--col: #1f78b4"} data)
    -   Observations [within]{.fg style="--col: #1f78b4"} pairs
    -   Patients [within]{.fg style="--col: #1f78b4"} hospitals
    -   People [within]{.fg style="--col: #1f78b4"} cities
    -   And so on...
:::

## Mixed-effects models

### Standard regression

::: {style="opacity: 1;"}
-   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Baseline
-   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Fixed]{.fg
    style="--col: #da291c"} effect
:::

:::: {style="opacity: 1;"}
::: {.text_block .important style="margin-left:15%; margin-top:9.9%"}
Outcome = [Intercept]{.fg style="--col: #1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects models

### Mixed-effects model

::: {style="opacity: 0.50;"}
-   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Baseline
-   [Slope]{.fg style="--col: #da291c"} [‚Üí]{.alert} [Fixed]{.fg
    style="--col: #da291c"} effect
:::

-   [New]{fg="#FFFFFF" bg="#31a354"} [‚Üí]{.alert} [Random]{fg="#FFFFFF"
    bg="#31a354"} effect(s) (i.e., [grouping factor]{fg="#FFFFFF"
    bg="#31a354"}, e.g., participant)

:::: {style="opacity: 0.50;"}
::: {.text_block .important style="margin-left:15%"}
Outcome = [Intercept]{.fg style="--col: #1f78b4"} + [Slope]{.fg
style="--col: #da291c"} \* predictor + Error
:::
::::

::: {.text_block .important style="margin-left:15%"}
Outcome = [Intercept]{.fg style="--col: #1f78b4"} + [Fixed]{.fg
style="--col: #da291c"} effect + [Random]{fg="#FFFFFF" bg="#31a354"}
effect(s) + Error
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects models

### Advantages over traditional methods

::: {.fragment .semi-fade-out fragment-index="1"}
-   Allow researchers to [avoid]{fg="#FFFFFF" bg="#1f78b4"}
    [averaging]{.fg style="--col: #1f78b4"} over the data
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [More flexible]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Can deal
    with [other types]{.fg style="--col: #1f78b4"} of outcome data
    (e.g., binary)
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
-   Handle [missing data]{.fg style="--col: #1f78b4"} and [unbalanced
    designs]{.fg style="--col: #1f78b4"} very well
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
-   Allow estimation:
    -   [Multiple effects]{.fg style="--col: #1f78b4"} on outcome
        variable (e.g., the effect of age and <br> feedback on language
        scores), and
    -   [Individual variation]{.fg style="--col: #1f78b4"} within and
        across subjects and items
:::

::: {.fragment .fade-in-then-semi-out fragment-index="4"}
-   Put simply, they allow [simultaneous]{.fg style="--col: #1f78b4"}
    modeling of [fixed]{.fg style="--col: #1f78b4"} and [random]{.fg
    style="--col: #da291c"} effects
    -   Hence, the name [‚Üí]{.alert} [Mixed-effects]{fg="#FFFFFF"
        bg="#1f78b4"} [models]{.fg style="--col: #1f78b4"}
:::

## Mixed-effects models

### [Fixed]{fg="#FFFFFF" bg="#1f78b4"} effects

::: {.fragment .semi-fade-out fragment-index="1"}
-   Account for [variation]{.fg style="--col: #1f78b4"} due to
    [experimental]{fg="#FFFFFF" bg="#1f78b4"} factors
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   Represent [average]{fg="#FFFFFF" bg="#1f78b4"} effects [‚Üí]{.alert}
    [Population-level]{.fg style="--col: #1f78b4"} effects
    -   Do [not]{.fg style="--col: #1f78b4"} change or vary across
        groups or over time
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
-   Factors with [limited]{.fg style="--col: #1f78b4"}, [repeatable]{.fg
    style="--col: #1f78b4"} levels (e.g., [group membership]{.fg
    style="--col: #1f78b4"})
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
-   Basically the [same]{fg="#FFFFFF" bg="#1f78b4"} condition effects
    [‚Üí]{.alert} [Standard]{.fg style="--col: #1f78b4"} regression
:::

## Mixed-effects models

### [Random]{fg="#FFFFFF" bg="#31a354"} effects

::: {.fragment .semi-fade-out fragment-index="1"}
-   Account for [variation]{.fg style="--col: #1f78b4"} due to
    collecting data from a [random]{fg="#FFFFFF" bg="#31a354"} sample
    <br> of a much larger population
    -   Account for variability [within]{fg="#FFFFFF" bg="#31a354"}
        groups
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   Represent [how much]{.fg style="--col: #1f78b4"} average effects
    ([trends]{.fg style="--col: #1f78b4"}) vary [across]{fg="#FFFFFF"
    bg="#31a354"} levels of <br> some [grouping factor]{.fg
    style="--col: #1f78b4"} (e.g., participants or items)
    -   [Particular]{.fg style="--col: #1f78b4"} groups might behave
        [differently]{fg="#FFFFFF" bg="#31a354"} from the average
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
-   Should have [at least 5]{fg="#FFFFFF" bg="#31a354"} levels
    -   [More]{fg="#FFFFFF" bg="#31a354"} levels [‚Üí]{.alert}
        [Preferable]{fg="#FFFFFF" bg="#31a354"} [@Brown-21]
:::

::: {.fragment .fade-in-then-semi-out fragment-index="4"}
-   Intrinsically [categorical]{fg="#FFFFFF" bg="#31a354"} [@Winter-19]
:::

::: {.text_size .important style="white-space:nowrap; font-size:83%"}
# Adding random intercepts and slopes {background-color="#40666e"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Research question (our quest)

-   [How]{fg="#FFFFFF" bg="#1f78b4"} does [word difficulty]{.fg
    style="--col: #1f78b4"} affect [response times]{.fg
    style="--col: #1f78b4"}?`r gen_fn(1, "fn1")`

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Standard regression: Fixed effects [only]{fg="#FFFFFF" bg="#1f78b4"}

-   [How]{fg="#FFFFFF" bg="#1f78b4"} does [word difficulty]{.fg
    style="--col: #1f78b4"} affect [response times]{.fg
    style="--col: #1f78b4"}?`r gen_fn(1, "fn1")`

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: center;"}
![](./img/fixed_effects_plot.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Mixed-effects: Adding random [intercepts]{fg="#FFFFFF" bg="#31a354"}

-   [How]{fg="#FFFFFF" bg="#1f78b4"} does [word difficulty]{.fg
    style="--col: #1f78b4"} affect [response times]{.fg
    style="--col: #1f78b4"}?`r gen_fn(1, "fn1")`

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: center;"}
![](./img/random_intercepts.png){fig-align="center" width="70%"
height="70%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### Mixed-effects: Adding random [slopes]{fg="#FFFFFF" bg="#31a354"}

-   [How]{fg="#FFFFFF" bg="#1f78b4"} does [word difficulty]{.fg
    style="--col: #1f78b4"} affect [response times]{.fg
    style="--col: #1f78b4"}?`r gen_fn(1, "fn1")`

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: center;"}
![](./img/random_slopes.png){fig-align="center" width="70%"
height="70%"}
:::
::::

## Making the case: Mixed-effects

### Skipping class case

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   What would we [call]{.fg style="--col: #1f78b4"} these regression
    lines?`r gen_fn(1, "fn1")`

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

## Making the case: Mixed-effects

### Skipping class case

```{r}
#| echo: false

gen_fn <- function(n, id) {
  # n is number of footnote
  # id is a unique id for that footnote
  paste0('<a href="#',id, '" class="footnote-ref" role="doc-noteref" aria-expanded="false"><sup>', n, '</sup></a>')
}
```

-   What would we [call]{.fg style="--col: #1f78b4"} these regression
    lines?`r gen_fn(1, "fn1")` [‚Üí]{.alert} [random slopes]{fg="#FFFFFF"
    bg="#31a354"}

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 3: Separate regression lines  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined

graph_three <-  ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
    #geom_smooth(method = "lm", se = FALSE, color = "black", size = 1.5) +  # Regression line for all data
    geom_smooth(method = "lm", 
        se = TRUE, 
        aes(group = class,
            color = class,
            ), 
        linetype = "solid") +  # Regression line per class
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_three <- arrangeGrob(
    graph_three,
    top = title.grob
)

grid.draw(graph_three)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Making the case: Mixed-effects

### [Random effects]{fg="#FFFFFF" bg="#31a354"}: [Everybody]{fg="#FFFFFF" bg="#1f78b4"} gets an estimate! üòÄ

::::: {.aling_fig_cap layout-valign="top" style="margin: auto;text-align: center;width:75%;margin-top:5%"}
:::: {.content-visible when-format="html"}
::: {.tenor-gif-embed data-postid="24849663" data-share-method="host" data-aspect-ratio="1.48837" data-width="100%"}
<a href="https://tenor.com/view/oprah-winfrey-gif-24849663">Oprah
Winfrey GIF</a>from
<a href="https://tenor.com/search/oprah+winfrey-gifs">Oprah Winfrey
GIFs</a>
:::

```{=html}
<script type="text/javascript" async src="https://tenor.com/embed.js"></script>
```
::::
:::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects modeling in action

### Technical caveat: [Shrinkage]{colour="#FFFFFF" bg-colour="#1f78b4"} (or partial pooling)

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Individual]{.fg style="--col: #1f78b4"} estimates [‚Üí]{.alert}
    [Pulled (]{.text_size .important
    style="white-space:nowrap; font-size:95%"}[shrunken]{.fg
    style="--col: #1f78b4"}) toward [average]{.fg
    style="--col: #da291c"} effects
:::

::::: {.fragment .fade-in-then-semi-out fragment-index="2"}
:::: {.regression_graph_1 .important style="margin-top: -0.2em"}
::: {.captions-fig style="text-align: center;"}
![Adapted from @Winter-19 [p.
271]](./img/shrinkage.png){fig-align="center" width="48%" height="45%"}
:::
::::
:::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.text_size .important style="white-space:nowrap; font-size:78%"}
# Contrasts coding: Categorical predictors {background-color="#40666e"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Continuous]{fg="#FFFFFF" bg="#31a354"} predictors

### Regression line[^2]

[^2]: Adapted from [Brehm & Alday (2020)](https://osf.io/jkpxt/)

-   (Conceptually & statistically) [Easy]{colour="#FFFFFF"
    bg-colour="#1f78b4"} [‚Üí]{.alert} Predictor = [Numbers]{.fg
    style="--col: #1f78b4"}

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                                Generate data                             ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
set.seed(12)
x <- 1:20 + rnorm(20)
x2 <- c(rep('a',10),rep('b',10))
x3 <- c(rep('control',10),rep('experimental',10))
y <- 1:20
d <- as.data.frame(cbind(x,x2,x3, y))
d$x <- as.numeric(d$x)
d$y <- as.numeric(d$y)
d$x_c <- scale(d$x, scale=FALSE)


##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                            Continuous variable                           ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



graph_cont <- 
    ggplot(d,aes(x=x,y=y))+geom_smooth(method='lm',
    color='darkcyan')+geom_point()+
    theme_bw()+
    scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  #theme_bw()+
  labs(x = "Predictor") +
  theme_minimalism_presentation()+
    theme(axis.text=element_text(size=16), 
        axis.title=element_text(size=16)) +
  theme_minimalism_presentation()
    

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Outcome",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cont<- arrangeGrob(
    graph_cont,
    top = title.grob
)

grid.draw(graph_cont)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Regression line`r gen_fn(2, "fn2")`

-   [Assigning]{.fg style="--col: #1f78b4"} values to
    [compare]{fg="#FFFFFF" bg="#1f78b4"} levels of categories

```{r}

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                            Categorical variable                          ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ categorical_variable  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_cat <- ggplot(d,aes(x=x2,y=y))+geom_point()+
  scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  #theme_bw()+
  labs(x = "Predictor") +
  theme_minimalism_presentation()+
    theme(axis.text=element_text(size=16), 
        axis.title=element_text(size=16))+
    geom_smooth(method='lm',color='darkcyan',
        aes(x=as.numeric(as.factor(x2))))

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Outcome",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cat <- arrangeGrob(
    graph_cat,
    top = title.grob
)

grid.draw(graph_cat)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Regression line`r gen_fn(2, "fn2")`

-   [Assigning]{.fg style="--col: #1f78b4"} values to
    [compare]{fg="#FFFFFF" bg="#1f78b4"} levels of categories

```{r}

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                            Categorical variable                          ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ categorical_variable: Example  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_cat_example <- ggplot(d,aes(x=x3,y=y ))+
  geom_point()+
  scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  #theme_bw()+
  labs(x = "Group") +
  theme_minimalism_presentation()+
    theme(axis.text=element_text(size=16), 
      axis.text.x = element_text(size = 16, color = thematic::okabe_ito()),
          #c("red", "blue")[1:2]),
        axis.title=element_text(size=16))+
    geom_smooth(method='lm',color='darkcyan',
        aes(x=as.numeric(as.factor(x3))))

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cat_example  <- arrangeGrob(
    graph_cat_example ,
    top = title.grob
)

grid.draw(graph_cat_example)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Coding schemes

-   Recoding variables [changes]{.fg style="--col: #1f78b4"} (i.e.,
    [facilitates]{fg="#FFFFFF" bg="#1f78b4"}) interpretation of data

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Coding schemes

::: {style="opacity: 0.50;"}
-   Recoding variables [changes]{.fg style="--col: #1f78b4"} (i.e.,
    [facilitates]{fg="#FFFFFF" bg="#1f78b4"}) interpretation of data
:::

::: {.model_types .important style="max-width:200%"}
![](./img/coding_categorical_1.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Coding schemes

::: {style="opacity: 0.50;"}
-   Recoding variables [changes]{.fg style="--col: #1f78b4"} (i.e.,
    [facilitates]{fg="#FFFFFF" bg="#1f78b4"}) interpretation of data
:::

::: {.coding .important style="max-width:150%"}
![](./img/coding_categorical_2.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Coding schemes: Dummy / treatment / baseline coding`r gen_fn(2, "fn2")`

-   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Represents the
    level coded = [0]{fg="#FFFFFF" bg="#1f78b4"}

```{r}

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                            Categorical variable                          ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

##~~~~~~~~~~~~~~~~~~~~~~
##  ~ Dummy coding  ----
##~~~~~~~~~~~~~~~~~~~~~~

graph_cat_dummy <-
  ggplot(d,aes(x=as.numeric(as.factor(x2))-1,y=y))+
    geom_point()+
  scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  theme_minimalism_presentation()+
    theme(axis.text=element_text(size=16), 
        axis.title=element_text(size=16))+
    geom_smooth(method='lm',color='darkcyan')+
    scale_x_continuous('Predictor',
      limits=c(-.4,1.4),
      breaks = c(0,1)) +
    geom_point(aes(x=0,y=5.5),color='orange',size=30,shape="*")#+
#    ggtitle('Dummy / treatment / baseline coding-- R default')

  
# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Outcome",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cat_dummy <- arrangeGrob(
    graph_cat_dummy,
    top = title.grob
)

grid.draw(graph_cat_dummy)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Categorical]{fg="#FFFFFF" bg="#1f78b4"} predictors

### Coding schemes: Sum / effect / deviation coding`r gen_fn(2, "fn2")`

-   [Intercept]{.fg style="--col: #1f78b4"} [‚Üí]{.alert} Represents
    [grand mean]{fg="#FFFFFF" bg="#1f78b4"}

```{r}

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                            Categorical variable                          ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Effect / sum / deviation coding  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_cat_sum <-
  ggplot(d,aes(x=as.numeric(as.factor(x2))-1.5,y=y))+
    geom_point()+
  scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  theme_minimalism_presentation()+
    theme(axis.text=element_text(size=16), 
        axis.title=element_text(size=16))+
    geom_smooth(method='lm',color='darkcyan')+
    scale_x_continuous('Predictor',
      limits=c(-.9,.9),
      breaks = c(-.5,.5))+
    geom_point(aes(x=0,y=10.5),color='orange',size=30,shape="*")#+
   # ggtitle('Effect / sum / deviation coding')
  
  
# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Outcome",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cat_sum <- arrangeGrob(
    graph_cat_sum,
    top = title.grob
)

grid.draw(graph_cat_sum)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.text_size .important style="white-space:nowrap; font-size:80%"}
# Mean centering: Continuous predictors {background-color="#40666e"}
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Continuous]{fg="#FFFFFF" bg="#31a354"} predictors

### Mean centering`r gen_fn(2, "fn2")`

-   [Rescaling]{.fg style="--col: #1f78b4"} predictor to [ease]{.fg
    style="--col: #1f78b4"} interpretation
    -   [Uncentered]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert}
        [Intercept]{.fg style="--col: #1f78b4"} = [Mean]{.fg
        style="--col: #1f78b4"} of original predictor

```{r fig.height= 4.5}


##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Uncentered variable  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_cont_uncentered <- 
  ggplot(d,aes(x=x,y=y))+geom_smooth(method='lm',
  color='darkcyan')+geom_point()+
  scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  #theme_bw()+
  labs(x = "Uncentered predictor") +
  theme_minimalism_presentation()+
  theme(axis.text=element_text(size=16), 
    axis.title=element_text(size=16),
    axis.text.x = element_text(color = "#1f78b4"),
    axis.title.x = element_text(color = "#1f78b4")
    )+
  geom_point(aes(x=10.16879,y=10.5),color='orange',size=30,shape="*")


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Outcome",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cont_uncentered <- arrangeGrob(
    graph_cont_uncentered,
    top = title.grob
)

grid.draw(graph_cont_uncentered)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## [Continuous]{fg="#FFFFFF" bg="#31a354"} predictors

### Mean centering`r gen_fn(2, "fn2")`

-   [Predictor -- Mean score]{.fg style="--col: #1f78b4"}
    -   [Centered]{fg="#FFFFFF" bg="#da291c"} [‚Üí]{.alert}
        [Intercept]{.fg style="--col: #1f78b4"} = Original mean becomes
        [0]{.fg style="--col: #1f78b4"} (["average"]{fg="#FFFFFF"
        bg="#1f78b4"} case)

```{r fig.height= 4.5}

###~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Centered variable  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_cont_centered <- 
  ggplot(d,aes(x=x_c,y=y))+geom_smooth(method='lm',
  color='darkcyan')+geom_point()+
  scale_y_continuous(
    name = NULL # Do not show y-axis label
  ) +
  #theme_bw()+
  theme_minimalism_presentation()+
  labs(x = "Centered predictor") +
  theme(axis.text=element_text(size=16), 
    axis.title=element_text(size=16),
    axis.text.x = element_text(color = "#da291c"),
    axis.title.x = element_text(color = "#da291c")
    )+
  geom_point(aes(x=0,y=10.5),color='orange',size=30,shape="*")#+

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Outcome",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_cont_centered <- arrangeGrob(
    graph_cont_centered,
    top = title.grob
)

grid.draw(graph_cont_centered)

```

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Pair work

-   Formulate a [question]{.fg style="--col: #1f78b4"} about what we
    have seen so far

::: {#Timer3 .timer seconds="120" starton="interaction" style="float: right; margin-top: 2em"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# [Your questions]{.fg style="--col: #1f78b4"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.text_size .important style="white-space:nowrap; font-size:80%"}
# Part II: Mixed-effects modeling in action {background-color="#40666e"}
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling

### Steps in data analysis [@Baayen-08]

::: {.fragment .semi-fade-out fragment-index="1"}
1.  [Visualization]{fg="#FFFFFF" bg="#1f78b4"} of data
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
2.  [Construction]{.fg style="--col: #1f78b4"} of initial model
    -   e.g., Fitting a linear model
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
3.  [Model criticism]{.fg style="--col: #1f78b4"}
    -   e.g., Verification of normality for residuals
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
4.  [Inspecting summary]{.fg style="--col: #1f78b4"} of model
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling {visibility="hidden"}

### Steps in data analysis [@Baayen-08]

::: {.block style="margin-right:50%"}
1.  [Visualization]{fg="#FFFFFF" bg="#1f78b4"} of data
:::

::: {.block style="margin-right:50%"}
2.  [Construction]{.fg style="--col: #1f78b4"} of initial model
    -   e.g., Fitting a linear model
:::

::: {.block style="margin-right:50%"}
3.  [Model criticism]{.fg style="--col: #1f78b4"}
    -   e.g., Verification of normality for residuals
:::

::: {.block style="margin-right:50%"}
4.  [Inspecting summary]{.fg style="--col: #1f78b4"} of model
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# [Practical work]{.fg style="--col: #1f78b4"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Workshop folder {visibility="hidden"}

-   Please download this folder: <https://tinyurl.com/2pb3vxmf>

![](./img/workshop_folder_2024_qr.svg){width="35%" height="15%"
fig-align="center"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.text_size .important style="white-space:nowrap; font-size:%"}
# Case study I: Skipping class {background-color="#40666e"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling

### Data visualization

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?

```{r}

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 2: Overall regression line  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Plot the data with a regression line for all classes combined
graph_two <- ggplot(df, aes(x = skipped_proportion, y = grade)) +
    geom_point(aes(), alpha = 0.6) +  # Scatter plot for data points
    geom_smooth(method = "lm", 
        se = TRUE, 
        color = "#1f78b4", 
        linewidth = 1.5) +  # Regression line for all data
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
    labs(x = "Proportion of skipped classes") +
    scale_color_manual(values= thematic::okabe_ito(3)) +
    #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
    theme(legend.title = element_blank()) +
    theme_minimalism_presentation()

# To see resulting graph
#graph_two 

# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_two <- arrangeGrob(
    graph_two,
    top = title.grob
)

grid.draw(graph_two)


```

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling (JASP)

### Standard regression

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_Std_regr_1.png){fig-align="left"}
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling (JASP)

### Standard regression

-   [Evidence]{fg="#FFFFFF" bg="#31a354"} [‚Üí]{.alert} [Skipping
    class]{.fg style="--col: #1f78b4"} [negatively]{fg="#FFFFFF"
    bg="#31a354"} affect grades (*p* \< .001) ([biased]{.fg
    style="--col: #da291c"})

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_Std_regr_2.png){fig-align="left"}
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Random intercepts

### Different intercepts, same slope

```{r}
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                          Graph 5: Same intercepts                        ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_five <-  
  ggplot(df, aes(x = skipped_proportion, y = grade)) +
  geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
  geom_smooth(method = "lm", 
    se = TRUE, 
    color = "black", size = 1.5, alpha = 0.6) +  # Regression line for all data
  geom_abline(
    slope = 0, 
    intercept = 0.84247, 
    color = "#E69F00", 
    size = 1) +   # Group 1
  geom_abline(
    slope = 0, 
    intercept = 0.67821, 
    color = "#009E73", 
    size = 1) +   # Group 
    geom_abline(
      slope = 0, 
      intercept = 0.88208, 
      color = "#0072B2", 
      size = 0.75) +   # Group 
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
  labs(x = "Proportion of skipped classes") +
  scale_color_manual(values= thematic::okabe_ito(3)) +
  #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
  theme(legend.title = element_blank()) +
  theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_five <- arrangeGrob(
    graph_five,
    top = title.grob
)

grid.draw(graph_five)

```

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling (JASP)

### Mixed-effects regression: Random intercepts

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_1a.png){fig-align="left"}
:::

## Regression modeling (JASP)

### Mixed-effects regression: Random intercepts

-   [Evidence]{fg="#FFFFFF" bg="#31a354"} [‚Üí]{.alert} [Skipping
    class]{.fg style="--col: #1f78b4"} [negatively]{fg="#FFFFFF"
    bg="#31a354"} affect grades (*p* \< .001) ([incomplete]{.fg
    style="--col: #da291c"})

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_1b.png){fig-align="left"}
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Random intercepts and random slopes

### Different intercepts, different slopes

```{r}
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  ~ Graph 6: Different intercepts and different slopes  ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

graph_six <-  
  ggplot(df, aes(x = skipped_proportion, y = grade)) +
  geom_point(aes(color = class), alpha = 0.6) +  # Scatter plot for data points
  geom_smooth(method = "lm", 
    se = TRUE, 
    color = "black", size = 1.5, alpha = 0.6) +  # Regression line for all data
  geom_abline(
      slope = 0.02492, 
      intercept = 0.84247, 
      color = "#E69F00", 
      size = 1) +   # Group 1
    geom_abline(
      slope = -0.08043, 
      intercept = 0.67821, 
      color = "#009E73", 
      size = 1) +   # Group 
    geom_abline(
      slope = -0.74609, 
      intercept = 0.88208, 
      color = "#0072B2", 
      size = 0.75) +   # Group 
  scale_y_continuous(
    limits = c(0, 1), 
    breaks = seq(0, 1, 
      by = 0.2),
    # labels = scales::label_number(accuracy = 1), 
    name = NULL # Do not show y-axis label
  ) +
  labs(x = "Proportion of skipped classes") +
  scale_color_manual(values= thematic::okabe_ito(3)) +
  #scale_color_manual(values = c("red", "green", "blue")) +  # Custom colors for each class
  theme(legend.title = element_blank()) +
  theme_minimalism_presentation()


# Add y-axis label horizontally
title.grob <- textGrob(
    gp = gpar(
        fontfamily = "Nunito",
         fontsize = 18
        # fontface = 'bold'
    ),
    label = "Grade",
    x = unit(0, "lines"),
    y = unit(0, "lines"),
    hjust = 0,
    vjust = -0.5
)

graph_six <- arrangeGrob(
    graph_six,
    top = title.grob
)

grid.draw(graph_six)

```

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling (JASP)

### Mixed-effects regression: Random intercepts and random slopes

-   What is the [effect]{fg="#FFFFFF" bg="#1f78b4"} of skipping class on
    grades?

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2a.png){fig-align="left"}
:::

```{r }
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Regression modeling (JASP)

### Mixed-effects regression: Random intercepts and random slopes

-   [No evidence]{fg="#FFFFFF" bg="#da291c"} [‚Üí]{.alert} [Skipping
    class]{.fg style="--col: #1f78b4"} effect on grades (*b* = -0.28,
    *SE* = 0.24, *p* = [.365]{.fg style="--col: #da291c"})

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2b.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

::: {.text_size .important style="white-space:nowrap; font-size:%"}
# Interpreting coefficients {background-color="#40666e"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Fixed effects (as in traditional regresion)

-   [Intercept]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} Estimated [mean
    grade]{.fg style="--col: #1f78b4"} for people who [never]{.fg
    style="--col: #1f78b4"} skipped class

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2c.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Fixed effects (as in traditional regresion)

-   [Intercept]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} When
    [skipped_proportion]{.fg style="font-family:Arial;--col: #1f78b4"}
    variable (predictor) = [0]{.fg style="--col: #1f78b4"}

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2c.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Fixed effects (as in traditional regresion)

-   [Intercept]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} [Estimated mean
    grade]{.fg style="--col: #1f78b4"} = [0.80]{fg="#FFFFFF"
    bg="#1f78b4"}

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2c.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Fixed effects (as in traditional regresion)

-   [Slope]{fg="#FFFFFF" bg="#da291c"} [‚Üí]{.alert}
    [One-unit]{fg="#FFFFFF" bg="#da291c"} increase in the proportion of
    classes skipped

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2b.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Fixed effects (as in traditional regresion)

-   [Slope]{fg="#FFFFFF" bg="#da291c"} [‚Üí]{.alert} Grade is expected to
    [decrease]{.fg style="--col: #1f78b4"} by [2.8]{fg="#FFFFFF"
    bg="#da291c"} points

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/skipping_class_ME_regr_2b.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [Intercept]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} Amount of
    [variability]{fg="#FFFFFF" bg="#31a354"} in grades across classes

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_1a.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [Intercept]{fg="#FFFFFF" bg="#1f78b4"} [‚Üí]{.alert} Fixed intercept
    (.80) varies by about *SD* = [0.09]{fg="#FFFFFF" bg="#1f78b4"}
    across classes

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_1a.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [Slope]{fg="#FFFFFF" bg="#da291c"} [‚Üí]{.alert} [[Amount of]{.fg
    style="font-size: 91%;"} [variability]{fg="#FFFFFF" bg="#31a354"} in
    [how]{.fg style="--col: #1f78b4"} skipping class [affects]{.fg
    style="--col: #1f78b4"} grades across classes]{.fg style="font-size: 90%"}

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_1b.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [Slope]{fg="#FFFFFF" bg="#da291c"} [‚Üí]{.alert} Fixed slope (i.e.,
    the effect = -0.28) varies *SD* = [0.40]{fg="#FFFFFF" bg="#da291c"}
    across classes

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_1b.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [More]{.fg style="--col: #1f78b4"} [variability]{fg="#FFFFFF"
    bg="#31a354"} in random [slopes]{.fg style="--col: #da291c"} than
    random intercepts

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_1b.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [Correlation]{.fg style="--col: #1f78b4"} random intercepts and
    random slopes [‚Üí]{.alert} [Negative]{.fg style="--col: #E69F00"}
    ([-0.49]{fg="#FFFFFF" bg="#E69F00"})

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_corr.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   Classes with [larger intercepts]{.fg style="--col: #1f78b4"}
    [‚Üí]{.alert} Tend to have [more negative slopes]{.fg
    style="--col: #da291c"}

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_corr.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   Skipping class [‚Üí]{.alert} [[Affects]{.fg style="--col: #1f78b4"}
    grades [more]{.fg style="--col: #1f78b4"} in classes with
    [higher]{.fg style="--col: #1f78b4"} grades from the start]{.fg style="font-size: 90%"}

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_corr.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   Skipping class [‚Üí]{.alert} [[Affects]{.fg style="--col: #1f78b4"}
    grades [more]{.fg style="--col: #1f78b4"} in classes with
    [higher]{.fg style="--col: #1f78b4"} grades from the start]{.fg style="font-size: 90%"}

::: {.coding .important style="width:%;transform: scale(1.2);margin-left: 10%;margin-top: 3%"}
![](./img/random_effect_corr.png){fig-align="left"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Mixed-effects: Estimate interpretation

### Random effects (new)

-   [Unexplained]{fg="#FFFFFF" bg="#da291c"} variability [‚Üí]{.alert}
    "Leftover" [noise]{.fg style="--col: #1f78b4"} in the model

::: {.coding .important style="width:%;transform: scale(1.3);margin-left: 15%;margin-top: 3%"}
![](./img/random_effect_res_err.png){fig-align="left"}
:::

::: {.text_size .important style="white-space:nowrap; font-size:%"}
# Analyzing reaction times  {background-color="#40666e"}
:::

## Regression modeling

### Analyzing reaction times 

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Aim]{.fg style="--col: #1f78b4"}:
    -   To test if sentence [grammaticality]{.fg style="--col: #1f78b4"}
        affect [reading times]{.fg style="--col: #1f78b4"} of L2
        learners
    -   [Outcome]{.fg style="--col: #1f78b4"} variable: Reaction times
        ([rt]{.fg style="--col: #1f78b4"})
    -   [Two-level]{.fg style="--col: #1f78b4"} predictor variable:
        [grammatical]{.fg style="--col: #1f78b4"} (GR) vs.
        [ungrammatical]{.fg style="--col: #da291c"} (UG)
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Hypotheses]{.fg style="--col: #1f78b4"}:
    -   [H~0~]{.fg style="--col: #1f78b4"}: [No]{.fg
        style="--col: #1f78b4"} difference in means of RTs
    -   [H~1~]{.fg style="--col: #1f78b4"}: [Longer]{.fg
        style="--col: #1f78b4"} (slower) RTs for [UG]{.fg
        style="--col: #1f78b4"} than GR stimuli [@Murphy-97]
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
-   [Research design]{.fg style="--col: #1f78b4"}:
    -   [Within-repeated-measures]{.fg style="--col: #1f78b4"}
        -   [All]{.fg style="--col: #1f78b4"} participants [judged]{.fg
            style="--col: #1f78b4"} the grammaticality of [all]{.fg
            style="--col: #1f78b4"} sentences
:::

::: {.text_size .important style="white-space:nowrap; font-size:75%"}
# Case study II: Binary outcome (Accuracy) {background-color="#40666e"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Accuracy]{.fg style="--col: #1f78b4"}
    -   Only [two]{.fg style="--col: #1f78b4"} possible options:
        -   Correct = [1]{.fg style="--col: #1f78b4"}
        -   Incorrect = [0]{.fg style="--col: #da291c"}
:::

:::: {.fragment .fade-in-then-semi-out fragment-index="2"}
::: {.big-code style="font-size: 150%; margin-top:1%;"}
``` {.r code-line-numbers="9"}
  subject                  score_accuracy
1   S_101                               0
2   S_101                               0
3   S_101                               1
4   S_101                               0
5   S_101                               1
6   S_101                               1
```
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

::: nonincremental
-   [Accuracy]{.fg style="--col: #1f78b4"}
    -   Only [two]{.fg style="--col: #1f78b4"} possible options:
        -   Correct = [success]{.fg style="--col: #1f78b4"}
        -   Incorrect = [failure]{.fg style="--col: #da291c"}
:::

:::: nonincremental
::: {.big-code style="font-size: 150%; margin-top:1%;"}
``` {.r code-line-numbers="9"}
  subject                  score_accuracy
1   S_101                               0
2   S_101                               0
3   S_101                               1
4   S_101                               0
5   S_101                               1
6   S_101                               1
```
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Accuracy]{.fg style="--col: #1f78b4"}
    -   As a [categorical]{.fg style="--col: #1f78b4"} variable:
        -   [Violates]{.fg style="--col: #1f78b4"} assumption of
            [linearity]{.fg style="--col: #1f78b4"} ([binary]{fg="#FFFFFF" bg="#1f78b4"} outcome)
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Linearity]{.fg style="--col: #1f78b4"}
    -   [Linear relationship]{.fg style="--col: #1f78b4"} between
        outcome and predictors
    -   [Changes]{.fg style="--col: #1f78b4"} in predictor [‚Üí]{.alert}
        [Constant]{.fg style="--col: #1f78b4"}, proportional changes in
        outcome
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

::::: {.fragment .semi-fade-out fragment-index="1"}
-   Standard [linear]{.fg style="--col: #1f78b4"} model [‚Üí]{.alert}
    [Cannot]{.fg style="--col: #1f78b4"} be [fit]{.fg
    style="--col: #1f78b4"}

:::: r-stack
::: {style="margin-left: 29.5%; margin-top: -2%;"}
Y = [b~0~]{.fg style="--col: #1f78b4"} + [b~1~]{.fg
style="--col: #da291c"}\* X + Œµ
:::
::::
:::::

::: incremental
-   [Logistic]{.fg style="--col: #1f78b4"} regression model:
    -   [Considers]{.fg style="--col: #1f78b4"} categorical [nature]{.fg
        style="--col: #1f78b4"} of outcome
    -   [Transforming]{.fg style="--col: #1f78b4"} outcome (Y)
        [‚Üí]{.alert} [Continuous]{.fg style="--col: #1f78b4"} scale ([log
        odds]{fg="#FFFFFF" bg="#1f78b4"})
    -   Predicting [probability]{.fg style="--col: #1f78b4"} of
        observing the outcome ([Y = 1]{fg="#FFFFFF" bg="#1f78b4"})
        -   [1]{.fg style="--col: #1f78b4"} / [0]{.fg
            style="--col: #da291c"}
    - In practice, Y can be any [two]{.fg
            style="--col: #1f78b4"} values:
        - [successes]{.fg
            style="--col: #1f78b4"} / [failures]{.fg
            style="--col: #da291c"}
        - [presence]{.fg
            style="--col: #1f78b4"} / [absence]{.fg
            style="--col: #da291c"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

-   [Outcome]{.fg style="--col: #1f78b4"}: Speech errors [‚Üí]{.alert}
    [Categorical]{.fg style="--col: #1f78b4"} variable ([yes]{.fg
    style="--col: #1f78b4"}; [no]{.fg style="--col: #da291c"})

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: center;"}
![Taken from @Winter-19 [p.
199]](./img/logistic_regression.png){fig-align="center" width="55%"
height="55%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

-   On [average]{.fg style="--col: #1f78b4"}, [drunk]{.fg
    style="--col: #1f78b4"} people [‚Üí]{.alert} Make [more]{.fg
    style="--col: #1f78b4"} speech errors than [sober]{.fg
    style="--col: #da291c"} people

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: center;"}
![Taken from @Winter-19 [p.
199]](./img/logistic_regression.png){fig-align="center" width="55%"
height="55%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

-   [Outcome]{.fg style="--col: #1f78b4"}: [Transformed]{.fg
    style="--col: #1f78b4"} with the [logistic function]{.fg
    style="--col: #1f78b4"}

:::: {.regression_graph_1 .important style="margin-top:"}
::: {.captions-fig style="text-align: center;"}
![Taken from @Winter-19 [p.
204]](./img/logistic_transform.png){fig-align="center" width="85%"
height="85%"}
:::
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

::: nonincremental
-   Predicting [log odds]{fg="#FFFFFF" bg="#1f78b4"} ([‚Äòlogits‚Äô]{.fg
    style="--col: #1f78b4"}) of the outcome
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

-   Predicting [log odds]{fg="#FFFFFF" bg="#1f78b4"} ([‚Äòlogits‚Äô]{.fg
    style="--col: #1f78b4"}) of the outcome
    -   [Positive]{.fg style="--col: #1f78b4"} ([+]{fg="#FFFFFF"
        bg="#1f78b4"}) log odds
        -   *Probability* [\>]{.fg style="--col: #1f78b4"} 0.5
            [‚Üí]{.alert} Above 50% [more]{fg="#FFFFFF" bg="#1f78b4"}
            likely to occur

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

-   Predicting [log odds]{fg="#FFFFFF" bg="#1f78b4"} ([‚Äòlogits‚Äô]{.fg
    style="--col: #1f78b4"}) of the outcome
    -   [Positive]{.fg style="--col: #1f78b4"} ([+]{fg="#FFFFFF"
        bg="#1f78b4"}) log odds
        -   *Probability* [\>]{.fg style="--col: #1f78b4"} 0.5
            [‚Üí]{.alert} Above 50% [more]{fg="#FFFFFF" bg="#1f78b4"}
            likely to occur
    -   [Negative]{.fg style="--col: #da291c"} ([-]{fg="#FFFFFF"
        bg="#da291c"}) log odds
        -   *Probability* [\<]{.fg style="--col: #da291c"} 0.5
            [‚Üí]{.alert} Above 50% [less]{fg="#FFFFFF" bg="#da291c"}
            likely to occur

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

:::: {.gift .important style="margin-top:1em"}
::: {.tenor-gif-embed data-postid="14280242" data-share-method="host" data-aspect-ratio="1.915" data-width="100%"}
<a href="https://tenor.com/view/never-tell-me-the-odds-star-wars-odds-never-gif-14280242">Never
Tell Me The Odds Star GIF</a>from
<a href="https://tenor.com/search/never+tell+me+the+odds-gifs">Never
Tell Me The Odds GIFs</a>
:::

```{=html}
<script type="text/javascript" async src="https://tenor.com/embed.js"></script>
```
::::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Logistic mixed-effects modeling

### Modeling a binomial outcome

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Aim]{.fg style="--col: #1f78b4"}:
    -   To test if [learning condition]{.fg style="--col: #1f78b4"}
        affect [accuracy]{.fg style="--col: #1f78b4"} of L2
        learners
    -   [Outcome]{.fg style="--col: #1f78b4"} variable: Accuracy: [correct (1)]{.fg style="--col: #1f78b4"} vs. [incorrect (0)]{.fg style="--col: #da291c"}
    -   [Two-level]{.fg style="--col: #1f78b4"} predictor variable:
        [incidental]{.fg style="--col: #1f78b4"} vs.
        [intentional]{.fg style="--col: #31a354"} 
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   [Hypotheses]{.fg style="--col: #1f78b4"}:
    -   [H~0~]{.fg style="--col: #1f78b4"}: [No]{.fg
        style="--col: #1f78b4"} difference in performance between groups 
    -   [H~1~]{.fg style="--col: #1f78b4"}: [Intentional]{.fg
        style="--col: #31a354"} group will perform better [@Kang.Sok.ea-19]
:::


```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

# Concluding remarks {background-color="#40666e"}

## Concluding remarks

### Mixed-effects modeling

::: {.fragment .semi-fade-out fragment-index="1"}
-   [Independence]{.fg style="--col: #1f78b4"} assumption [‚Üí]{.alert}
    [Fundamental]{colour="#FFFFFF" bg-colour="#31a354"}
:::

::: {.fragment .fade-in-then-semi-out fragment-index="1"}
-   Aggregation [conceals]{.fg style="--col: #1f78b4"} data
    [variability]{.fg style="--col: #1f78b4"}
:::

::: {.fragment .fade-in-then-semi-out fragment-index="2"}
-   [State-of-the-art]{colour="#FFFFFF" bg-colour="#1f78b4"},
    [flexible]{.fg style="--col: #1f78b4"} method:
    -   Accounting for [variability]{.fg style="--col: #1f78b4"} in
        linguisitic data
        -   [Simultaneously]{.fg style="--col: #1f78b4"} model
            participant and item effects\
:::

::: {.fragment .fade-in-then-semi-out fragment-index="3"}
-   Consequently, our [results]{.fg style="--col: #1f78b4"} are
    [closer]{colour="#FFFFFF" bg-colour="#1f78b4"} to the truth.
:::

# Thank you! üòÄ {background-color="#40666e"}

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## Presentation slides here: {visibility="hidden"}

<https://tinyurl.com/yry6e4hy>

::: {.qr .important style="margin-top:1em"}
![](./img/slides_mixed_effect_upna_qr.svg){width="35%" height="15%"
fig-align="center"}
:::

```{r}
     #                            SLIDE                            ~~~
     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

## 

### References
